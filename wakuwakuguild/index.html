<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>âš”ï¸ ã‚ãã‚ãã‚®ãƒ«ãƒ‰</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <div class="container">
      <h1>âš”ï¸ ã‚ãã‚ãã‚®ãƒ«ãƒ‰</h1>
      <nav>
        <a href="index.html">ã‚¯ã‚¨ã‚¹ãƒˆæ²ç¤ºæ¿</a>
        <a href="ranking.html">ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a>
        <a href="member.html">ãƒ¡ãƒ³ãƒãƒ¼ç™»éŒ²</a>
        <a href="client.html">ä¾é ¼ä¸»ç™»éŒ²</a>
        <a href="mypage.html">ãƒã‚¤ãƒšãƒ¼ã‚¸</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <div class="hero">
        <h2>ğŸ—ºï¸ å‹Ÿé›†ä¸­ã®ã‚¯ã‚¨ã‚¹ãƒˆ</h2>
        <p>ç·ç¤¾å¸‚ã‚®ãƒ«ãƒ‰äº‹å‹™å±€ãŒèªå®šã—ãŸä¾é ¼ä¸€è¦§ã§ã™ã€‚ã‚ãªãŸã®ã‚¹ã‚­ãƒ«ã§åœ°åŸŸã‚’æ”¯ãˆã‚ˆã†ï¼</p>
      </div>

      <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒ¼ -->
      <div class="filter-bar">
        <label>
          ã‚«ãƒ†ã‚´ãƒª:
          <select id="categoryFilter">
            <option value="">ã™ã¹ã¦</option>
            <option value="è‰åˆˆã‚Š">ğŸŒ¿ è‰åˆˆã‚Š</option>
            <option value="æ¸…æƒ">ğŸ§¹ æ¸…æƒ</option>
            <option value="åŠ›ä»•äº‹">ğŸ’ª åŠ›ä»•äº‹</option>
            <option value="ITæ”¯æ´">ğŸ’» ITæ”¯æ´</option>
            <option value="æ–™ç†ãƒ»èª¿ç†">ğŸ³ æ–™ç†ãƒ»èª¿ç†</option>
            <option value="ã‚¤ãƒ™ãƒ³ãƒˆæ‰‹ä¼ã„">ğŸ‰ ã‚¤ãƒ™ãƒ³ãƒˆæ‰‹ä¼ã„</option>
            <option value="ãã®ä»–">ğŸ“¦ ãã®ä»–</option>
          </select>
        </label>

        <label>
          é›£æ˜“åº¦:
          <select id="difficultyFilter">
            <option value="">ã™ã¹ã¦</option>
            <option value="1">â˜…</option>
            <option value="2">â˜…â˜…</option>
            <option value="3">â˜…â˜…â˜…</option>
            <option value="4">â˜…â˜…â˜…â˜…</option>
            <option value="5">â˜…â˜…â˜…â˜…â˜…</option>
          </select>
        </label>

        <label>
          æ¨å¥¨ãƒ©ãƒ³ã‚¯:
          <select id="rankFilter">
            <option value="">ã™ã¹ã¦</option>
            <option value="F">Fï¼ˆåˆå¿ƒè€…ï¼‰</option>
            <option value="E">E</option>
            <option value="D">D</option>
            <option value="C">C</option>
            <option value="B">B</option>
            <option value="A">A</option>
            <option value="S">Sï¼ˆãƒ™ãƒ†ãƒ©ãƒ³ï¼‰</option>
          </select>
        </label>

        <button id="filterBtn">çµã‚Šè¾¼ã¿</button>
        <button id="resetBtn" class="btn-secondary">ãƒªã‚»ãƒƒãƒˆ</button>
      </div>

      <!-- ã‚¯ã‚¨ã‚¹ãƒˆä¸€è¦§ -->
      <div id="questList">
        <div class="loading">ğŸ”„ ã‚¯ã‚¨ã‚¹ãƒˆã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</div>
      </div>
    </div>
  </main>

  <footer>
    <p>Â© 2026 ç·ç¤¾å¸‚ã‚®ãƒ«ãƒ‰äº‹å‹™å±€ | ã‚ãã‚ãã‚®ãƒ«ãƒ‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</p>
  </footer>

  <script src="js/config.js"></script>
  <script>
    // ãƒšãƒ¼ã‚¸å›ºæœ‰ã®åˆæœŸåŒ–
    function initializePage() {
      loadQuests();
      setupFilters();
    }

    /**
     * ã‚¯ã‚¨ã‚¹ãƒˆä¸€è¦§ã‚’èª­ã¿è¾¼ã‚€
     */
    async function loadQuests(filters = {}) {
      Utils.showLoading('questList');
      
      try {
        const quests = await API.get('getQuests', filters);
        
        if (quests && quests.length > 0) {
          displayQuests(quests);
        } else {
          Utils.showNoData('questList', 'ç¾åœ¨å‹Ÿé›†ä¸­ã®ã‚¯ã‚¨ã‚¹ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ğŸ˜¢<br>æ–°ã—ã„ã‚¯ã‚¨ã‚¹ãƒˆã‚’ãŠå¾…ã¡ãã ã•ã„ï¼');
        }
      } catch (error) {
        console.error('ã‚¯ã‚¨ã‚¹ãƒˆèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        Utils.showError('questList', 'ã‚¯ã‚¨ã‚¹ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
      }
    }

    /**
     * ã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡¨ç¤º
     */
    function displayQuests(quests) {
      const questList = document.getElementById('questList');
      questList.innerHTML = '';
      questList.className = 'quest-grid';
      
      quests.forEach((quest, index) => {
        const card = createQuestCard(quest, index);
        questList.appendChild(card);
      });
    }

    /**
     * ã‚¯ã‚¨ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰ã‚’ä½œæˆ
     */
    function createQuestCard(quest, index) {
      const card = document.createElement('div');
      card.className = 'quest-card';
      card.style.animationDelay = `${index * 0.1}s`;
      
      const difficulty = DIFFICULTIES[quest.difficulty] || DIFFICULTIES[3];
      const remainingText = quest.remainingSlots > 0 ? 
        `<span style="color: #4caf50;">æ®‹ã‚Š${quest.remainingSlots}å</span>` : 
        '<span style="color: #f44336;">å‹Ÿé›†çµ‚äº†</span>';
      
      card.innerHTML = `
        <div class="quest-header">
          <h3>${quest.title}</h3>
          <div class="difficulty" title="${difficulty.label}">${difficulty.stars}</div>
        </div>
        <div class="quest-body">
          <p>ğŸ“ ${quest.location}</p>
          <p>ğŸ“… ${Utils.formatDate(quest.desiredDate)}</p>
          <p>ğŸ’° å ±é…¬: <strong class="reward-amount">${Utils.formatCurrency(quest.reward)}</strong></p>
          <p>ğŸ‘¥ å‹Ÿé›†: ${quest.currentMembers || 0}/${quest.requiredMembers}å ${remainingText}</p>
          <p>ğŸ¯ æ¨å¥¨ãƒ©ãƒ³ã‚¯: ${Utils.getRankBadge(quest.recommendRank)}</p>
        </div>
        <div class="quest-footer">
          ${Utils.getCategoryBadge(quest.category)}
          <button onclick="location.href='quest-detail.html?id=${quest.id}'">
            è©³ç´°ã‚’è¦‹ã‚‹ âš”ï¸
          </button>
        </div>
      `;
      
      return card;
    }

    /**
     * ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­å®š
     */
    function setupFilters() {
      const filterBtn = document.getElementById('filterBtn');
      const resetBtn = document.getElementById('resetBtn');
      const categoryFilter = document.getElementById('categoryFilter');
      const difficultyFilter = document.getElementById('difficultyFilter');
      const rankFilter = document.getElementById('rankFilter');
      
      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
      filterBtn.addEventListener('click', () => {
        const filters = {};
        
        if (categoryFilter.value) filters.category = categoryFilter.value;
        if (difficultyFilter.value) filters.difficulty = difficultyFilter.value;
        if (rankFilter.value) filters.rank = rankFilter.value;
        
        loadQuests(filters);
      });
      
      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆ
      resetBtn.addEventListener('click', () => {
        categoryFilter.value = '';
        difficultyFilter.value = '';
        rankFilter.value = '';
        loadQuests();
      });
    }
  </script>
</body>
</html>