<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚¯ã‚¨ã‚¹ãƒˆæŠ•ç¨¿ - ã‚ãã‚ãã‚®ãƒ«ãƒ‰</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <div class="container">
      <h1>âš”ï¸ ã‚ãã‚ãã‚®ãƒ«ãƒ‰</h1>
      <nav>
        <a href="index.html">ã‚¯ã‚¨ã‚¹ãƒˆæ²ç¤ºæ¿</a>
        <a href="ranking.html">ãƒ©ãƒ³ã‚­ãƒ³ã‚°</a>
        <a href="member.html">ãƒ¡ãƒ³ãƒãƒ¼ç™»éŒ²</a>
        <a href="client.html">ä¾é ¼ä¸»ç™»éŒ²</a>
        <a href="mypage.html">ãƒã‚¤ãƒšãƒ¼ã‚¸</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="form-section">
      <h2>ğŸ“ ã‚¯ã‚¨ã‚¹ãƒˆæŠ•ç¨¿</h2>
      <p>ã‚®ãƒ«ãƒ‰ãƒ¡ãƒ³ãƒãƒ¼ã«ä¾é ¼ã—ãŸã„ä»•äº‹ã‚’æŠ•ç¨¿ã—ã¾ã—ã‚‡ã†</p>

      <div class="form-group">
        <label for="clientId">ä¾é ¼ä¸»ID <span class="required">*</span></label>
        <input type="text" id="clientId" name="clientId" required placeholder="ä¾‹: C0001">
        <small>ç™»éŒ²æ™‚ã«ç™ºè¡Œã•ã‚ŒãŸIDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</small>
      </div>

      <form id="questForm" onsubmit="submitQuestForm(event)">
        <div class="form-group">
          <label for="questTitle">ã‚¯ã‚¨ã‚¹ãƒˆå <span class="required">*</span></label>
          <input type="text" id="questTitle" name="questTitle" required placeholder="ä¾‹: åº—èˆ—å‰ã®è‰åˆˆã‚Š">
        </div>

        <div class="form-group">
          <label for="category">ã‚«ãƒ†ã‚´ãƒª <span class="required">*</span></label>
          <select id="category" name="category" required>
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="è‰åˆˆã‚Š">è‰åˆˆã‚Š</option>
            <option value="æ¸…æƒ">æ¸…æƒ</option>
            <option value="åŠ›ä»•äº‹">åŠ›ä»•äº‹</option>
            <option value="ITæ”¯æ´">ITæ”¯æ´</option>
            <option value="æ–™ç†ãƒ»èª¿ç†">æ–™ç†ãƒ»èª¿ç†</option>
            <option value="ã‚¤ãƒ™ãƒ³ãƒˆæ‰‹ä¼ã„">ã‚¤ãƒ™ãƒ³ãƒˆæ‰‹ä¼ã„</option>
            <option value="ãã®ä»–">ãã®ä»–</option>
          </select>
        </div>

        <div class="form-group">
          <label for="difficulty">é›£æ˜“åº¦ <span class="required">*</span></label>
          <select id="difficulty" name="difficulty" required>
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="â˜…">â˜…ï¼ˆç°¡å˜ãƒ»åˆå¿ƒè€…OKï¼‰</option>
            <option value="â˜…â˜…">â˜…â˜…ï¼ˆã‚„ã‚„ç°¡å˜ï¼‰</option>
            <option value="â˜…â˜…â˜…">â˜…â˜…â˜…ï¼ˆæ™®é€šï¼‰</option>
            <option value="â˜…â˜…â˜…â˜…">â˜…â˜…â˜…â˜…ï¼ˆã‚„ã‚„é›£ã—ã„ï¼‰</option>
            <option value="â˜…â˜…â˜…â˜…â˜…">â˜…â˜…â˜…â˜…â˜…ï¼ˆé«˜é›£åº¦ï¼‰</option>
          </select>
          <small>ä½œæ¥­ã®é›£æ˜“åº¦ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚é›£æ˜“åº¦ãŒé«˜ã„ã»ã©ãƒ¡ãƒ³ãƒãƒ¼ã®ç²å¾—çµŒé¨“å€¤ãŒå¢—ãˆã¾ã™ã€‚</small>
        </div>

        <div class="form-group">
          <label for="recommendRank">æ¨å¥¨ãƒ©ãƒ³ã‚¯ <span class="required">*</span></label>
          <select id="recommendRank" name="recommendRank" required>
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="F">Fï¼ˆåˆå¿ƒè€…ï¼‰</option>
            <option value="E">E</option>
            <option value="D">D</option>
            <option value="C">C</option>
            <option value="B">B</option>
            <option value="A">A</option>
            <option value="S">Sï¼ˆãƒ™ãƒ†ãƒ©ãƒ³ï¼‰</option>
          </select>
          <small>æ¨å¥¨ãƒ©ãƒ³ã‚¯æœªæº€ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚‚å¿œå‹Ÿå¯èƒ½ã§ã™ãŒã€ç›®å®‰ã¨ã—ã¦ã”è¨­å®šãã ã•ã„ã€‚</small>
        </div>

        <div class="form-group">
          <label for="description">å†…å®¹è©³ç´° <span class="required">*</span></label>
          <textarea id="description" name="description" rows="6" required placeholder="ä½œæ¥­å†…å®¹ã‚’è©³ã—ãè¨˜è¼‰ã—ã¦ãã ã•ã„&#10;ä¾‹: åº—èˆ—å‰ã®ç©ºãåœ°ï¼ˆç´„100ã¡ï¼‰ã®è‰åˆˆã‚Šã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚è‰åˆˆã‚Šæ©Ÿã¯å½“æ–¹ã§ç”¨æ„ã—ã¾ã™ã€‚"></textarea>
        </div>

        <div class="form-group">
          <label for="location">å®Ÿæ–½å ´æ‰€ <span class="required">*</span></label>
          <input type="text" id="location" name="location" required placeholder="ç·ç¤¾å¸‚â—‹â—‹ç”º1-2-3">
          <small>è©³ç´°ãªä½æ‰€ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„</small>
        </div>

        <div class="form-group">
          <label for="desiredDate">å¸Œæœ›æ—¥æ™‚ <span class="required">*</span></label>
          <input type="datetime-local" id="desiredDate" name="desiredDate" required>
        </div>

        <div class="form-group">
          <label for="estimatedHours">æ‰€è¦æ™‚é–“ï¼ˆäºˆå®šï¼‰ <span class="required">*</span></label>
          <input type="text" id="estimatedHours" name="estimatedHours" required placeholder="ä¾‹: 3æ™‚é–“">
        </div>

        <div class="form-group">
          <label for="reward">å ±é…¬é¡ï¼ˆç¨è¾¼ï¼‰ <span class="required">*</span></label>
          <input type="number" id="reward" name="reward" required min="1000" step="1000" placeholder="15000">
          <small>å ±é…¬é¡ã¯1,000å††ä»¥ä¸Šã§è¨­å®šã—ã¦ãã ã•ã„ã€‚æºæ³‰å¾´åç¨ï¼ˆ10.21%ï¼‰ãŒå·®ã—å¼•ã‹ã‚Œã¾ã™ã€‚</small>
        </div>

		<!-- â˜…ã“ã“ã«è¿½åŠ  -->
		<div class="form-group">
		  <label for="rewardType">å ±é…¬ã®ç¨®é¡ <span class="required">*</span></label>
		  <select id="rewardType" name="rewardType" required onchange="updateRewardDisplay()">
		    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
		    <option value="total">ç·é¡ï¼ˆãƒãƒ¼ãƒ å…¨ä½“ã§å—ã‘å–ã‚‹é‡‘é¡ï¼‰</option>
		    <option value="perPerson">1äººã‚ãŸã‚Šï¼ˆå„ãƒ¡ãƒ³ãƒãƒ¼ãŒå—ã‘å–ã‚‹é‡‘é¡ï¼‰</option>
		  </select>
		  <small id="rewardNote" style="display:none; color: #2563eb; font-weight: bold;"></small>
		</div>

        <div class="form-group">
          <label for="requiredMembers">å¿…è¦äººæ•° <span class="required">*</span></label>
          <input type="number" id="requiredMembers" name="requiredMembers" required min="1" max="10" value="1">
          <small>è¤‡æ•°äººå¿…è¦ãªå ´åˆã¯äººæ•°ã‚’æŒ‡å®šã—ã¦ãã ã•ã„</small>
        </div>

        <div class="form-group">
          <label for="equipment">å¿…è¦ãªé“å…·ãƒ»è£…å‚™</label>
          <textarea id="equipment" name="equipment" rows="3" placeholder="ä¾‹: è‰åˆˆã‚Šæ©Ÿï¼ˆå½“æ–¹ã§ç”¨æ„ï¼‰ã€è»æ‰‹ã€é•·é´"></textarea>
        </div>

        <div class="form-group">
          <label for="notes">æ³¨æ„äº‹é …ãƒ»å‚™è€ƒ</label>
          <textarea id="notes" name="notes" rows="3" placeholder="é§è»Šå ´ã®æœ‰ç„¡ã€é›¨å¤©æ™‚ã®å¯¾å¿œãªã©"></textarea>
        </div>

        <div class="form-group">
          <label>
            <input type="checkbox" name="agree" required>
            ã‚¯ã‚¨ã‚¹ãƒˆæ‰¿èªæ™‚ã«å ±é…¬ç›¸å½“é¡ã‚’äº‹å‹™å±€ã«é ã‘ã‚‹ã“ã¨ã«åŒæ„ã—ã¾ã™
          </label>
        </div>

        <button type="submit" class="btn-primary" id="submitBtn">ã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ç¨¿ã™ã‚‹</button>
      </form>

      <div class="info-box">
        <h3>ğŸ’¡ ã‚¯ã‚¨ã‚¹ãƒˆæŠ•ç¨¿ã®æµã‚Œ</h3>
        <ol>
          <li>ã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã‚’å…¥åŠ›ã—ã¦æŠ•ç¨¿</li>
          <li>äº‹å‹™å±€ãŒå†…å®¹ã‚’å¯©æŸ»ï¼ˆ1-2å–¶æ¥­æ—¥ï¼‰</li>
          <li>æ‰¿èªã•ã‚ŒãŸã‚¯ã‚¨ã‚¹ãƒˆãŒæ²ç¤ºæ¿ã«æ²è¼‰</li>
          <li>ã‚®ãƒ«ãƒ‰ãƒ¡ãƒ³ãƒãƒ¼ãŒå—æ³¨</li>
          <li>ä½œæ¥­å®Œäº†å¾Œã€ä¾é ¼ä¸»ãŒç¢ºèª</li>
          <li>äº‹å‹™å±€ã‹ã‚‰ãƒ¡ãƒ³ãƒãƒ¼ã¸å ±é…¬æ”¯æ‰•</li>
        </ol>
      </div>
    </section>
  </main>

  <footer>
    <p>&copy; 2026 ç·ç¤¾å¸‚ã‚®ãƒ«ãƒ‰äº‹å‹™å±€ | ã‚ãã‚ãã‚®ãƒ«ãƒ‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</p>
  </footer>

  <script src="js/config.js"></script>
  <script>
async function submitQuestForm(event) {
  event.preventDefault();
  
  const clientId = document.getElementById('clientId').value;
  if (!clientId) {
    alert('ä¾é ¼ä¸»IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }

  const submitBtn = document.getElementById('submitBtn');
  submitBtn.disabled = true;
  submitBtn.textContent = 'é€ä¿¡ä¸­...';
  
  const formData = new FormData(event.target);
  
  const questData = {
    clientId: clientId,
    questTitle: formData.get('questTitle'),
    category: formData.get('category'),
    difficulty: formData.get('difficulty'),
    recommendRank: formData.get('recommendRank'),
    description: formData.get('description'),
    location: formData.get('location'),
    desiredDate: formData.get('desiredDate'),
    estimatedHours: formData.get('estimatedHours'),
    reward: parseInt(formData.get('reward')),
    requiredMembers: parseInt(formData.get('requiredMembers')),
    equipment: formData.get('equipment'),
    notes: formData.get('notes')
  };

  try {
    const response = await fetch(GAS_WEB_APP_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'text/plain',
      },
      body: JSON.stringify({
        action: 'registerQuest',
        data: questData
      })
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const result = await response.json();
    
    if (result.success) {
      alert(`âœ… ã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ç¨¿ã—ã¾ã—ãŸï¼\n\nã‚¯ã‚¨ã‚¹ãƒˆID: ${result.questId}\n\näº‹å‹™å±€ã®å¯©æŸ»å¾Œã€æ²ç¤ºæ¿ã«æ²è¼‰ã•ã‚Œã¾ã™ã€‚\nå¯©æŸ»çµæœã¯ãƒ¡ãƒ¼ãƒ«ã§ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚`);
      event.target.reset();
      document.getElementById('clientId').value = clientId;
    } else {
      alert('âŒ æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\n\n' + (result.message || 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'));
    }
  } catch (error) {
    console.error('æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:', error);
    alert('âŒ æŠ•ç¨¿å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\n\n' + error.message + '\n\nãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ã€ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
  } finally {
    submitBtn.disabled = false;
    submitBtn.textContent = 'ã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ç¨¿ã™ã‚‹';
  }
}
    /**
 * æ—¥ä»˜ã‚’æ—¥æœ¬èªå½¢å¼ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
 */
function formatDate(dateString) {
  if (!dateString) return '-';
  
  try {
    const date = new Date(dateString);
    
    // ç„¡åŠ¹ãªæ—¥ä»˜ãƒã‚§ãƒƒã‚¯
    if (isNaN(date.getTime())) return '-';
    
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const hour = String(date.getHours()).padStart(2, '0');
    const minute = String(date.getMinutes()).padStart(2, '0');
    
    return `${year}å¹´${month}æœˆ${day}æ—¥ ${hour}:${minute}`;
  } catch (error) {
    return '-';
  }
}

/**
 * æ—¥ä»˜ã®ã¿è¡¨ç¤ºï¼ˆæ™‚åˆ»ãªã—ï¼‰
 */
function formatDateOnly(dateString) {
  if (!dateString) return '-';
  
  try {
    const date = new Date(dateString);
    if (isNaN(date.getTime())) return '-';
    
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    
    return `${year}å¹´${month}æœˆ${day}æ—¥`;
  } catch (error) {
    return '-';
  }
}

/**
 * ç›¸å¯¾æ™‚é–“è¡¨ç¤ºï¼ˆâ—‹æ—¥å‰ã€â—‹æ™‚é–“å‰ãªã©ï¼‰
 */
function formatRelativeTime(dateString) {
  if (!dateString) return '-';
  
  try {
    const date = new Date(dateString);
    if (isNaN(date.getTime())) return '-';
    
    const now = new Date();
    const diffMs = now - date;
    const diffSec = Math.floor(diffMs / 1000);
    const diffMin = Math.floor(diffSec / 60);
    const diffHour = Math.floor(diffMin / 60);
    const diffDay = Math.floor(diffHour / 24);
    
    if (diffSec < 60) return `${diffSec}ç§’å‰`;
    if (diffMin < 60) return `${diffMin}åˆ†å‰`;
    if (diffHour < 24) return `${diffHour}æ™‚é–“å‰`;
    if (diffDay < 7) return `${diffDay}æ—¥å‰`;
    
    return formatDateOnly(dateString);
  } catch (error) {
    return '-';
  }
}
  </script>
</body>
</html>
